@page
@model StockChart.Pages.Payments.PaymentsTableModel

@using Kendo.Mvc.Extensions;
@using Kendo.Mvc.Infrastructure;
@using Kendo.Mvc.UI;
@using StockChart.Model.Payments;

@{
    //Layout = "_LayoutReport";
    ViewData["Title"] = "Таблица платежей";
}

<link href="/Content/main.css" rel="stylesheet" type="text/css" />
<link href="/Content/component-new-menu.css" rel="stylesheet" type="text/css" />
<link href="/Content/common.css" rel="stylesheet" type="text/css" />
<link href="/Content/index.css" rel="stylesheet" type="text/css" />
<div class="leftsidebar">
    <partial name="LeftMenu" />
</div>

<div class="widerightsidebar">
    <div class="blogblock">

@(Html.Kendo().Grid<PaymentModel>()
    .Name("Grid")
    .Columns(columns =>
    {
        columns.Bound(o => o.Id).Hidden();
        columns.Bound(o => o.UserName);
        columns.Bound(o => o.Email);//.Editable(editable => false);
        columns.Bound(o => o.PayDate).Width(180).Format("{0: dd.MM.yyyy}");
        columns.Bound(o => o.ExpireDate).Width(180).Format("{0: dd.MM.yyyy}");
        columns.Bound(o => o.PayAmount).Format("{0: n2}");
        columns.Bound(o => o.Service).Width(80);
        columns.Command(command => command.Destroy()).Width(150);
    })
    .ToolBar(toolbar =>
          {
              toolbar.Create();
              toolbar.Save();
          })
    .Pageable()
    .Events(e => e.Edit("onEdit"))
    //
    .Sortable()
    .Filterable()
    .Scrollable()
    .HtmlAttributes(new { style = "height:750px;" })       
    .Editable(editable => editable.Mode(GridEditMode.InCell))
    .DataSource(dataSource => dataSource
        .Ajax()
        .Batch(true)
         .Model(model =>
            {
                model.Id(p => p.Id);
                //model.Field(p => p.Email).Editable(false);
                model.Field(p => p.Service).DefaultValue(1);
            })
        .ServerOperation(false)
        .Read(read => read.Action("Read", "Payments"))
        .Destroy(read => read.Action("Destroy", "Payments"))
        .Update(read => read.Action("Update", "Payments"))
        .Create(read => read.Action("Create", "Payments"))
        .PageSize(22)
    )
)
    </div>
</div>

<script>
    function onEdit(e) {
        if (e.model.isNew()) {
      //      alert(e.model);
        }
    }
</script>


