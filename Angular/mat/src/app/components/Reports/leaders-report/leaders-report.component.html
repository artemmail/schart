<div class="container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        Лидеры российского рынка акций
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div>
        <div class="flex-container">
          <div class="flex-item">
            <app-market-selector
              [(ngModel)]="selectedMarket"
              (selectionChange)="onMarketChange($event)"
            ></app-market-selector>
          </div>

          <div class="flex-item">
            <app-combobox
              [label]="'Выборка'"
              [(value)]="top"
              [items]="topPreset"
              (selectionChange)="getLeaders()"
            ></app-combobox>
          </div>

          <div class="flex-item">
            <app-date-range-selector
              [ticker]="ticker"
              [rperiod]="'day'"
              (selectionChange)="applyPreset($event)"
            ></app-date-range-selector>
          </div>

          <div class="flex-item">
            <app-date-range-picker></app-date-range-picker>
          </div>

          <div class="flex-item">
            <button mat-raised-button color="primary" (click)="getLeaders()">
              Показать
            </button>
          </div>
        </div>

        <table mat-table [dataSource]="dataSource" matSort class="custom-table">
          <ng-container matColumnDef="ticker">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Бумага</th>
            <td mat-cell *matCellDef="let element">
              <div class="ticker-container">
                <app-ticker-icon [ticker]="element.ticker"></app-ticker-icon>
                <a [routerLink]="['/FootPrint']" [queryParams]="{ ticker: element.ticker, period: 5, rperiod: 'day' }">
                  {{ element.name.substring(0, 25) }}
                </a>
              </div>
            </td>
          </ng-container>

          <!-- New Columns: Fundamental, MSFO/РНБО, Dividends, Owners placed after Бумага -->
          <ng-container matColumnDef="fundamental">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Финансовые показатели</th>
            <td mat-cell *matCellDef="let element" class="icon-cell">
              <a [routerLink]="['/Financial', element.ticker]">
                <mat-icon>description</mat-icon>
              </a>
            </td>
          </ng-container>

          <ng-container matColumnDef="msfo">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>МСФУ/РНБО</th>
            <td mat-cell *matCellDef="let element" class="icon-cell">
              <a [routerLink]="['/statements', element.ticker]">
                <mat-icon>description</mat-icon>
              </a>
            </td>
          </ng-container>

          <ng-container matColumnDef="dividends">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Диви-денды</th>
            <td mat-cell *matCellDef="let element" class="icon-cell">
              <a [routerLink]="['/Dividends', element.ticker]">
                <mat-icon>attach_money</mat-icon>
              </a>
            </td>
          </ng-container>

          <ng-container matColumnDef="owners">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Собст-венники</th>
            <td mat-cell *matCellDef="let element" class="icon-cell">
              <a [routerLink]="['/ShareHolders', element.ticker]">
                <mat-icon>group</mat-icon>
              </a>
            </td>
          </ng-container>

          <ng-container matColumnDef="opn">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Открытие</th>
            <td mat-cell *matCellDef="let element">{{ element.opn }}</td>
          </ng-container>

          <ng-container matColumnDef="cls">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Закрытие</th>
            <td mat-cell *matCellDef="let element" [ngStyle]="{ color: element.color }">
              {{ element.cls }}
            </td>
          </ng-container>

          <ng-container matColumnDef="volume">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Объем</th>
            <td mat-cell *matCellDef="let element">
              {{ element.volume | moneyToStr }}
            </td>
          </ng-container>

          <ng-container matColumnDef="percent">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Изм%</th>
            <td mat-cell *matCellDef="let element" [ngStyle]="{ color: element.color }">
              {{ element.percent }}
            </td>
          </ng-container>

          <ng-container matColumnDef="bid">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>ASK%</th>
            <td mat-cell *matCellDef="let element">{{ element.bid }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="getDisplayedColumns()"></tr>
          <tr mat-row *matRowDef="let row; columns: getDisplayedColumns()"></tr>
        </table>

        <mat-paginator [pageSize]="100" [pageSizeOptions]="[5, 10, 20, 100]" showFirstLastButtons></mat-paginator>
      </div>
    </mat-card-content>
  </mat-card>
</div>
