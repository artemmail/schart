<div class="order-book">
  <div class="order-book__loading" *ngIf="isLoading">
    <mat-progress-spinner diameter="24" mode="indeterminate"></mat-progress-spinner>
    <span>Загрузка...</span>
  </div>

  <div class="order-book__empty" *ngIf="!isLoading && !bids.length && !asks.length">
    Нет данных
  </div>

  <div class="order-book__content" *ngIf="!isLoading && (bids.length || asks.length)">
    <div class="order-book__chart">
      <svg viewBox="0 0 100 40" preserveAspectRatio="none" aria-hidden="true">
        <defs>
          <linearGradient id="bidFill" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" stop-color="#38c976" stop-opacity="0.35"></stop>
            <stop offset="100%" stop-color="#38c976" stop-opacity="0"></stop>
          </linearGradient>
          <linearGradient id="askFill" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" stop-color="#f16c6c" stop-opacity="0.35"></stop>
            <stop offset="100%" stop-color="#f16c6c" stop-opacity="0"></stop>
          </linearGradient>
        </defs>
        <path class="order-book__chart-area bid" [attr.d]="bidChartAreaPath" fill="url(#bidFill)"></path>
        <path class="order-book__chart-area ask" [attr.d]="askChartAreaPath" fill="url(#askFill)"></path>
        <path class="order-book__chart-line bid" [attr.d]="bidChartPath"></path>
        <path class="order-book__chart-line ask" [attr.d]="askChartPath"></path>
      </svg>
    </div>

    <div class="order-book__labels">
      <span class="order-book__label bid">ПОКУПКА</span>
      <span class="order-book__label ask">ПРОДАЖА</span>
    </div>

    <div class="order-book__table" [style.max-height.px]="tableMaxHeightPx">
      <div class="order-book__row" *ngFor="let row of rows; trackBy: trackByRow">
        <div class="order-book__cell order-book__price left">
          {{ row.bidPrice !== null ? (row.bidPrice | number : '1.2-6') : '-' }}
        </div>
        <div
          class="order-book__cell order-book__volume bid"
          [style.--bar-width]="getBidWidth(row.bidVolume) + '%'"
        >
          {{ row.bidVolume !== null ? (row.bidVolume | number : '1.0-0') : '' }}
        </div>
        <div class="order-book__divider"></div>
        <div
          class="order-book__cell order-book__volume ask"
          [style.--bar-width]="getAskWidth(row.askVolume) + '%'"
        >
          {{ row.askVolume !== null ? (row.askVolume | number : '1.0-0') : '' }}
        </div>
        <div class="order-book__cell order-book__price right">
          {{ row.askPrice !== null ? (row.askPrice | number : '1.2-6') : '—' }}
        </div>
      </div>
    </div>
  </div>
</div>
